{% extends 'user_base.html' %}
{% block title %}My Feedback - CleanZone{% endblock %}

{% block content %}
<div class="container-fluid py-5" style="background-color: #f1f1f1; min-height: 100vh;">
  <div class="container text-center">
    <h2 class="fw-bold mb-2">My Feedback</h2>
    <p class="text-muted mb-5">Here’s what you have shared about our services</p>

    {% if feedbacks %}
    <div class="row justify-content-center">
      {% for feedback in feedbacks %}
      <div class="col-lg-8 mb-4">
        <div class="card border-0 shadow-sm p-4" style="border-radius: 20px;">
          <div class="row align-items-center">
            <!-- Image Section -->
            <div class="col-md-4 text-center mb-3 mb-md-0">
              {% if feedback.image %}
              <div style="border: 4px solid #007bff; border-radius: 15px; overflow: hidden; display: inline-block;">
                <img src="{{ feedback.image.url }}" alt="Feedback image" 
                     class="img-fluid" 
                     style="width: 100%; height: 250px; object-fit: cover;">
              </div>
              {% else %}
              <div class="bg-secondary d-flex align-items-center justify-content-center text-white"
                   style="width: 100%; height: 250px; border-radius: 15px;">
                <span>No Image</span>
              </div>
              {% endif %}
            </div>

            <!-- Feedback Content -->
            <div class="col-md-8 text-start">
              <!-- ⭐ Star Rating Display -->
              <div class="mb-2">
                {% for i in "12345" %}
                  {% if forloop.counter <= feedback.rating %}
                    <i class="bi bi-star-fill text-warning" style="font-size: 1.2rem;"></i>
                  {% else %}
                    <i class="bi bi-star text-warning" style="font-size: 1.2rem;"></i>
                  {% endif %}
                {% endfor %}
              </div>

              <p class="fst-italic mb-3">“{{ feedback.comment }}”</p>
              <p class="text-muted mb-2">
                <small>{{ feedback.created_at|date:"M d, Y H:i" }}</small>
              </p>

              <div class="d-flex gap-2">
                <a href="{% url 'edit_feedback' feedback.id %}" class="btn btn-warning btn-sm">Edit</a>
                <a href="{% url 'delete_feedback' feedback.id %}" 
                   class="btn btn-danger btn-sm"
                   onclick="return confirm('Are you sure you want to delete this feedback?');">Delete</a>
              </div>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <p class="text-muted">You have not submitted any feedback yet.</p>
    {% endif %}
  </div>
</div>

<!-- Bootstrap Icons (for star icons) -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
{% endblock %}